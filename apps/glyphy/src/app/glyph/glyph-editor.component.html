<svg #svgRef class="glyph"
	[gViewBox]="(_viewBox$ | async)"
>
	<g g-glyph-metrics
		class="metrics"
		*ngIf="(_viewBox$ | async) as viewBox"
		[glyph]="glyph"
		[viewBox]="viewBox"
		[gTransform]="renderTransform"
		[lineThickness]="metricsThickness"
		[scaleFactor]="_scaleFactor"
	/>

	<ng-container *ngIf="(_familyService.family$ | async) as family">
	<ng-container *ngIf="(_contentRect$ | async) as rect">
		<rect class="metrics-text background"
			[gTransform]="_clientToView"
			[attr.x]="rect.x"
			[attr.y]="rect.y"
			[attr.width]="72"
			[attr.height]="rect.height"
		/>

		<text class="metrics-text asc"
			gHybridCoordSpace
			[xTransform]="_clientToView"
			[xPosition]="rect.x + 16"
			[yTransform]="renderTransform"
			[yPosition]="family.ascender"
		>
			asc
		</text>
		<text class="metrics-text caps"
			*ngIf="family.capHeight"
			gHybridCoordSpace
			[xTransform]="_clientToView"
			[xPosition]="rect.x + 16"
			[yTransform]="renderTransform"
			[yPosition]="family.capHeight"
		>
			caps
		</text>
		<text class="metrics-text x-hgt"
			*ngIf="family.xHeight"
			gHybridCoordSpace
			[xTransform]="_clientToView"
			[xPosition]="rect.x + 16"
			[yTransform]="renderTransform"
			[yPosition]="family.xHeight"
		>
			x-hgt
		</text>
		<text class="metrics-text base"
			gHybridCoordSpace
			[xTransform]="_clientToView"
			[xPosition]="rect.x + 16"
			[yTransform]="renderTransform"
			[yPosition]="0"
		>
			base
		</text>
		<text class="metrics-text desc"
			gHybridCoordSpace
			[xTransform]="_clientToView"
			[xPosition]="rect.x + 16"
			[yTransform]="renderTransform"
			[yPosition]="family.descender"
		>
			desc
		</text>
	</ng-container>
	</ng-container>

	<g class="pointer">
		<line
			*ngIf="_modifiers.includes(ModifierKey.Control)"
			[attr.x1]="_pointer?.x"
			[attr.x2]="_pointer?.x"
			y1="-10000"
			y2="10000"
		/>
		<line
			*ngIf="_modifiers.includes(ModifierKey.Control)"
			x1="-10000"
			x2="10000"
			[attr.y1]="_pointer?.y"
			[attr.y2]="_pointer?.y"
		/>
	</g>

	<path class="outline"
		[attr.d]="glyph.outline?.svg"
		[gTransform]="renderTransform"
	/>

	<g class="points"
		[gTransform]="renderTransform"
	>
		<g class="contour"
			*ngFor="let contour of glyph.outline?.contours
				let idx = index
				trackBy: trackByIndex"
			[g-glyph-contour]="contour"
			[scaleFactor]="_scaleFactor"
			[clientToGlyphCoords]="clientToGlyphCoords"
			(update)="updatePoint(idx, $event.index, $event.point)"
		></g>
	</g>
</svg>

<section class="ui-overlay">
	<div class="pointer-coords" *ngIf="_pointerCoords">
		<span class="x">X: {{ _pointerCoords.x | number : '1.0-0' }}</span>
		<span class="y">Y: {{ _pointerCoords.y | number : '1.0-0' }}</span>
	</div>
</section>
