<elx-app-shell
	fakeWindowsChrome
	[maximized]="maximized"
>
	<elx-titlebar
		(minimize)="minimize()"
		[(maximized)]="maximized"
		(close)="close()"
	>
		<elx-icon *elxTitlebarIcon icon="Entity" />

		<elx-menubar>
			<elx-menuitem [elxMenuTriggerFor]="fileMenu">
				File
			</elx-menuitem>
			<elx-menuitem disabled>
				Edit
			</elx-menuitem>
			<elx-menuitem disabled>
				Help
			</elx-menuitem>
		</elx-menubar>

		<div class="title" elxTitlebarTitle>
			<span class="title__app">Glyphy</span>
			@if ((_familyService.family$ | async); as family) {
				<em class="title__sep">/</em>
				<span class="title__project">{{ family.name }}</span>
				@if ((_familyService.font$ | async); as font) {
					<em class="title__sep">/</em>
					<span class="title__project">{{ font.styleName }}</span>
				}
			}
		</div>
	</elx-titlebar>

	<elx-menu #fileMenu>
		<elx-menuitem icon="NewFolder" keybind="Ctrl + N"
			(click)="newFamilyDialog = true"
		>
			New Project...
		</elx-menuitem>
		<elx-menuitem icon="FolderOpen" keybind="Ctrl + O"
			(click)="_familyService.open()"
		>
			Open Project...
		</elx-menuitem>
		<elx-menuitem disabled>
			Recent Projects
		</elx-menuitem> <!-- TODO -->
		<hr />
		<!-- [disabled]="!(_project.home$ | async)" -->
		<elx-menuitem (click)="importFont()">
			Import Font...
		</elx-menuitem>
	</elx-menu>

	<elx-main-viewport class="main">
		@if ((_familyService.family$ | async)) {
			<g-family-panel class="sidebar" />
		}

		@let font = (_familyService.font$ | async);
		<div class="content">
			@if (font) {
				<elx-tab-list #tabs
					indicator="top"
					[(activeIndex)]="activeTabIndex"
				>
					<elx-tab class="tab tab--home" aria-label="Home">
						<elx-icon icon="Home" size="lg" />
					</elx-tab>
					@for (glyph of (openGlyphs$ | async);
						let i = $index;
						track "{{glyph.fontStyle}} {{glyph.name}}")
					{
						<elx-tab class="tab"
							removable
							(remove)="closeGlyph(i)"
						>
							<strong class="tab__name">
								{{ glyph.name }}
							</strong>
							<span class="tab__unicode">
								{{ glyph.unicode | hex : 4 }}
							</span>
						</elx-tab>
					}
				</elx-tab-list>
				<elx-tab-group [for]="tabs">
					<g-font-explorer
						*elxTabPanel
						(openGlyph)="openGlyph($event)"
					/>
					@for (glyph of (openGlyphs$ | async);
						track "{{glyph.fontStyle}} {{glyph.name}}")
					{
						<g-glyph-editor
							*elxTabPanel
							[glyph]="glyph"
						/>
					}
				</elx-tab-group>
			} @else {
				<button elx-btn="primary"
					class="get-started"
					(click)="importFont()"
				>
					Get Started
				</button>
			}

		</div>

		<g-new-family-dialog
			*elxDialogTrigger="newFamilyDialog"
			blocking
			(confirm)="createFamily($event[0], $event[1])"
			(cancel)="newFamilyDialog = false"
		/>

	</elx-main-viewport>
</elx-app-shell>
